<!DOCTYPE html>
<html><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title></title>
    <base href="https://andirko.eu">
    <meta name="description" content="">
    <meta name="author" content=''>

    <link href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">

    
    <link rel="stylesheet" href="/sass/researcher.min.css">

    
        <link rel="icon" type="image/ico" href="https://andirko.eu/favicon.svg">
    
	
</head>

    <body><div class="container mt-5">
    <nav class="navbar navbar-expand-sm flex-column flex-sm-row p-0">
        <a class="navbar-brand mr-sm-auto" href="https://andirko.eu">Alejandro M. Andirkó</a>
        <div class="navbar-nav flex-row">
            
                
                
                    <a class="nav-item nav-link" href="/about">About</a>
                    
                        <span class="nav-item navbar-text mx-1">/</span>
                    
                
                    <a class="nav-item nav-link" href="/cv.pdf">CV</a>
                    
                        <span class="nav-item navbar-text mx-1">/</span>
                    
                
                    <a class="nav-item nav-link" href="/posts">Posts</a>
                    
                        <span class="nav-item navbar-text mx-1">/</span>
                    
                
                    <a class="nav-item nav-link" href="/contact">Contact</a>
                    
                
            
        </div>
    </nav>
</div>
<hr>
<div id="content">
<div class="container">
    <h1 id="loops">Loops</h1>
<p>As in many other programming language, in <code>bash</code>, the terminal language, you can create loops. They won’t be always necessary, but they can come in handy. Here’s an example for basic loop structure in <code>bash</code> to capture with <code>grep</code> all rs SNP ids of any <code>.out</code> files included in a list contained in a given <code>-f</code>ile called <code>hfsapiens.rsids</code>:</p>
<pre><code>for i in *.out; do 
    fgrep -f hfsapiens.rsids $i &gt; $i.rs
done
</code></pre>
<p><strong>Question:</strong> what do you think will be the name of the output files here?
<strong>Question:</strong> There is a problem with this loop. What is it? How would you solve it?
****<strong>Exercise:</strong> create a for loop to print all third columns of a set of <code>.csv</code> files.</p>
<p><strong>The files from the exercise we started with</strong>
We actually used a loop to generate the 1000 files we used for the exercise in the beginning of the course. The only thing we started with was a list of a lost of genes (<code>genes.txt</code>), which Alejandro already had. Here’s the loop:</p>
<pre><code>for n in {1..1000}; do
        shuf genes.txt | head -n 1000 &gt; list_$n.txt
done
</code></pre>
<p>This can be translated as:
For every number from 1 to 1000, do this (in other words, do this 1000 times):</p>
<pre><code>shuffle the `genes.txt` file, then take the first 1000 lines of that, and save it in a file, whose name is `list_` + the number you’re in.
that’s all.
</code></pre>
<p><code>shuf</code> shuffles lines. We then pipe (<code>|</code>) the result into <code>head</code>, which we set for <code>1000</code> lines with the <code>-n</code> option, and we then output (<code>&gt;</code>) that to a .txt file which uses the varible <code>n</code> as part of the name, which we can refer to by doing <code>$n</code>. Since <code>n</code> will go up every time this whole thing happens, until we reach 1000 times, our files will be numbered from 1 to 1000.</p>
<p>Running this takes literally around 5 seconds. Think about that: from a given list of genes, we generated 1000 lists, each different from each other, with 1000 random genes, and put each of these lists in a file, named the way we wanted, in the format we chose. Executing this takes 5 seconds (coming up with it and writing it for the first time takes maybe a couple of minutes). Think of doing this manually. Even if you’re great with excel, we guarantee it will not take 5 seconds, not will it be possible to include in a workflow. Then imagine that after you give me what you did I tell you “oh, sorry, the original list of genes had a mistake; there’s a gene that shouldn’t be there. Could you do it again?”. If you use a loop like this, it shouldn’t worry you; you just make sure you have the updated <code>genes.txt</code> file, without the gene that shouldn’t be there, run the loop again, and after 5 seconds you’re good. If you used some other method, you might kill me after I ask you to repeat.</p>
<h1 id="package-management">Package management</h1>
<p>All of these commands are little programs that come with your computer. <code>grep</code> and <code>ls</code> and so on are somewhere in your computer, and your computer calls them up when you type their name. Sometimes you might find a cool terminal solution for a problem, only to find you get a <code>command not found</code> message or similar. This means you either typed it wrong (so you can easily fix that), or you don’t actually have this command available to you. Why that is can vary, but there are ways of getting the program, and that is using a package manager. What does this mean? It means installing something that allows you to easily get new little programs you can call up on the terminal. One example is <code>youtube-dl</code>, which we mentioned in the beginning as an example of a cool program that accomplishes something which is a pain otherwise. Go to your favorite YouTube video, copy the address, and do this (replace the address I chose with your favorite):</p>
<p><code>youtube-dl https://www.youtube.com/watch?v=q6EoRBvdVPQ</code></p>
<p>You will get a command not found message. You don’t have <code>youtube-dl</code> available to you. So let’s get a package manager, so that in the future you can easily get the missing program you need.</p>
<h2 id="macos">MacOS</h2>
<p>A popular package manager for MacOS is <code>homebrew</code>. Go here and follow the instructions: <a href="https://brew.sh">https://brew.sh</a></p>
<p>You will see the instructions actually involve simply pasting a line onto the terminal and running it. It will download and install whatever it needs, and you’re set. Now you have homebrew, and you can easily get new packages/programs/commands that you can use on the terminal. Let’s try to get <code>youtube-dl</code>. Just do the following:</p>
<p><code>brew install youtube-dl</code></p>
<p>That’s it. Let’s say one day you find a great script or line to solve something, but it includes a command called <code>andirko</code> that you’ve never seen and you get an error message?
Just do <code>brew install andirko</code> and you’re set.</p>
<h2 id="linux">Linux</h2>
<p>Linux distributions vary in terms of what package managers come by default. Ubuntu, for example, comes with <code>apt</code>. There are others, but it’s very likely you have <code>apt</code> in your Linux system. To install <code>youtube-dl</code>, do:</p>
<pre><code>sudo apt install youtube-dl
</code></pre>
<p>(you will be prompted to enter your password, since this requires admin privileges).</p>
<p>That’s it! Now you have <code>youtube-dl</code>.</p>
<p>Note: if you try to install a program and it says it can’t find it, it could be that the program is part of a “bundle” of programs, is which what you have to install. Some googling would tell you this. For example, <code>shuf</code>, which shuffles lines in a file, is part of something called <code>coreutils</code> on MacOS, which is what you have to install (<code>brew install coreutils</code>).</p>
<h2 id="might-as-well-try-out-youtube-dl">Might as well try out <code>youtube-dl</code></h2>
<p>Press the up arrow to go back to the commands you typed before and find the one where you try to download your favorite YouTube video. Mine is like this:</p>
<pre><code>youtube-dl https://www.youtube.com/watch?v=q6EoRBvdVPQ
</code></pre>
<p>After I run it, it immediately downloads the video to the folder I’m in. Neat! Actually, if you explore the options of this command (you know how), you will see you’ll be able to do things that even the YouTube website doesn’t allow, like download videos that are blocked in your region, for example. You can also do cool things like have a file with several URLs and download them all at once. You can also just get the audio. Good for getting stuff to listen to later.</p>
<h2 id="other-cool-programs-we-mentioned-earlier">Other cool programs we mentioned earlier.</h2>
<p><strong>pandoc</strong>
pandoc converts between different kinds of “documents”. Go here for some examples: <a href="https://pandoc.org/demos.html">https://pandoc.org/demos.html</a>. For example, let’s say I have a <code>.tex</code> file and want it in word (<code>docx</code>). I can do:</p>
<pre><code>pandoc -s file.tex -o file.docx
</code></pre>
<p>Try it with a <code>.tex</code> file you might have in your computer.</p>
<p><strong>ffmpeg</strong></p>
<p>You can easily convert an audio or video format into another format, or a video file into an audio file (in other words, extract audio from a video). In the following example, I’m extracting audio to an .<code>mp3</code> file from an <code>.avi</code> video file:</p>
<p><code>ffmpeg -ii myrecording.avi myrecording.mp3</code></p>
<p><code>ffmpeg</code> is faster, more reliable and much more versatile than some dodgy programs or websites you might find that supposedly do the same. Good graphical programs that do this cost good money. You can do it for free.</p>
<h1 id="project-organization">Project organization</h1>
<h2 id="good-practices">Good practices</h2>
<p>Anyone who is responsible for a project should be able to know where things are when needed. If in two years someone emails one of us asking to share piece of data x, or to be sent analysis y, or a better quality version of a figure, if the person responsible for the project has no idea where it is it looks bad (and an excuse given to the person asking for this info will look bad too). We are already lacking a lab, so we should at least have good data practices.</p>
<h2 id="folder-structure">Folder structure</h2>
<pre><code>Project_name ← folder for the whole project
├── data ← “raw” data
├── figures ← folder with all figures (used and unused), including editable files
├── paper ← folder with the paper(s) written as part of the project
│   ├── paper.tex
│   └── paper.pdf
├── readme.md ← a file with a description of the project, and any instructions
└── scripts ← a folder with all scripts used in the project
</code></pre>
<p><img src="https://paper-attachments.dropbox.com/s_80C52D30149D05CE50019398E91C36B8884EAA6FE3817F926C6C76654C69A50F_1583237567628_Screen+Shot+2020-03-03+at+12.12.22.png" alt=""></p>
<p>(I actually have a script that creates this structure. It doesn’t mean it would be very hard to do it by hand, of course (it isn’t), but this guarantees it stays consistent, and it does save a little bit of time).</p>
<p>We don’t have to get into it now, but it looks like this:</p>
<pre><code>project() { mkdir -p &quot;$@&quot;/{paper,scripts,data,figures} &amp;&amp; touch &quot;$@&quot;/readme.md &amp;&amp; cd &quot;$@&quot;/paper &amp;&amp; texpaper &quot;$@&quot;.tex ;}
</code></pre>
<p>if I want a project called “language”, all I have to do is:</p>
<pre><code>project language
</code></pre>
<p>And it will create everything for me.</p>

</div>

        </div>
    <div id="footer">
        <hr>
        <div class="container text-center mb-2">
            <a href="https://andirko.eu"><small>Last updated: 2/10/2020 </small></a>
        </div>
    </div>

</body>
</html>
